#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

	Если Параметры.Свойство("АвтоТест") Тогда
		Возврат;
	КонецЕсли;
	
	Номенклатура = Неопределено;
	
	Если Параметры.Свойство("Номенклатура", Номенклатура) 
		И ЗначениеЗаполнено(Номенклатура) Тогда
		ВестиУчетПоНоменклатуреГТД = Неопределено;
		Если Справочники.Номенклатура.ПроверитьИспользованиеНоменклатурыГТД(Номенклатура, ВестиУчетПоНоменклатуреГТД) Тогда
			
			Если Не ВестиУчетПоНоменклатуреГТД Тогда
				ЭтаФорма.АвтоЗаголовок = Ложь;
				ЭтаФорма.Заголовок = НСтр("ru='Код номенклатуры для НН и номер ГТД (справочно)';uk='Код номенклатури для ПН та номер ВМД (довідково)'");
			КонецЕсли;
				
			УстановитьОтборПоУмолчанию(Номенклатура);
			
		Иначе
			ТекстИсключения = НСтр("ru='Для данной номенклатуры запрещено использование кодов УКТВЭД и номеров ГТД.';uk='Для даної номенклатури заборонено використання кодів УКТЗЕД та номерів ВМД.'");
			ВызватьИсключение ТекстИсключения;
			
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры // ПриСозданииНаСервере()

&НаКлиенте
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	Если ИмяСобытия = "Запись_ХарактеристикиНоменклатуры" 
		И ЗначениеЗаполнено(Источник) Тогда
		Элементы.Список.ТекущаяСтрока = Источник;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьОтборПоУмолчанию(Владелец)
	
	// Отбор по владельцу не должен быть доступен пользователю 
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбора(
		Список.Отбор,
		"Владелец",
		Владелец,
		ВидСравненияКомпоновкиДанных.Равно, "ОтборПоУмолчанию" ,Истина
	);
	
КонецПроцедуры

#КонецОбласти
