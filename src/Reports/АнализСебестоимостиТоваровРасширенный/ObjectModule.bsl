#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
#Область ОбработчикиСобытий

Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	ПользовательскиеНастройкиМодифицированы = Ложь;
	
	КонтрольИспользованияАналитикиОборотов(КомпоновщикНастроек);
	
	СхемаКомпоновкиДанных.НаборыДанных.ОсновнаяАналитика.Запрос = ИсполняемыйЗапросОсновнаяАналитика();
	СхемаКомпоновкиДанных.НаборыДанных.ОборотнаяАналитика.Запрос = ИсполняемыйЗапросОборотнаяАналитика();
	СхемаКомпоновкиДанных.НаборыДанных.Документы.Запрос = ИсполняемыйЗапросДокументы();
	
	УстановитьОбязательныеНастройки(ПользовательскиеНастройкиМодифицированы);
	
	УдалитьПоказателиИзОтборовРасшифровки(КомпоновщикНастроек);
	
	НастройкиОтчета = КомпоновщикНастроек.ПолучитьНастройки();
	
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, НастройкиОтчета, ДанныеРасшифровки);
	
	// Проверим, используются ли оборотные аналитики
	КомпоновкаДанныхСервер.ОптимизацияИспользованияОборотнойАналитики(МакетКомпоновки, СхемаКомпоновкиДанных, НастройкиОтчета, ДанныеРасшифровки);
	
	КомпоновкаДанныхСервер.УстановитьЗаголовкиМакетаКомпоновки(СтруктураЗаголовковПолей(), МакетКомпоновки);
	
	ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(МакетКомпоновки, , ДанныеРасшифровки, Истина);
	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	ПроцессорВывода.Вывести(ПроцессорКомпоновки);
	
	КомпоновкаДанныхСервер.ОформитьДиаграммыОтчета(КомпоновщикНастроек, ДокументРезультат);
	
	ВспомогательныеПараметры = Новый Массив;
	КомпоновкаДанныхСервер.ДобавитьВспомогательныеПараметрыОтчетаПоФункциональнымОпциям(ВспомогательныеПараметры);
	КомпоновкаДанныхСервер.СкрытьВспомогательныеПараметрыОтчета(
		СхемаКомпоновкиДанных, КомпоновщикНастроек, ДокументРезультат, ВспомогательныеПараметры);
	КомпоновкаДанныхСервер.СкрытьВспомогательныеПараметрыОтчета(
		СхемаКомпоновкиДанных, КомпоновщикНастроек, ДокументРезультат, ВспомогательныеПараметрыОтчета());
	
	// Сообщим форме отчета, что настройки модифицированы
	Если ПользовательскиеНастройкиМодифицированы Тогда
		КомпоновщикНастроек.ПользовательскиеНастройки.ДополнительныеСвойства.Вставить("ПользовательскиеНастройкиМодифицированы", Истина);
	КонецЕсли;
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура КонтрольИспользованияАналитикиОборотов(КомпоновщикНастроек)
	Группировки = КомпоновкаДанныхКлиентСервер.ПолучитьГруппировки(КомпоновщикНастроек);
	
	Для Каждого Группировка Из Группировки Цикл 
		ПоляГруппировки = Группировка.Значение.ПоляГруппировки.Элементы;
		КоличествоПолейАналитикиОборотов = 0;
		Для Каждого ПолеГруппировки Из ПоляГруппировки Цикл 
			Если Найти(Строка(ПолеГруппировки.Поле), "АналитикаОборотов") >0 Тогда
				КоличествоПолейАналитикиОборотов = КоличествоПолейАналитикиОборотов + 1; 
			КонецЕсли;
			Если КоличествоПолейАналитикиОборотов > 1 Тогда
				ВызватьИсключение НСтр("ru='Множественное использование полей аналитики оборотов в группировках не поддерживается.';uk='Множинне використання полів аналітики оборотів в групуваннях не підтримується.'") ;
			КонецЕсли;
		КонецЦикла;
		Если КоличествоПолейАналитикиОборотов >= 1 И ПоляГруппировки.Количество() > 1 Тогда
			ВызватьИсключение НСтр("ru='Совместное использование в группировках полей аналитики оборотов и других полей не поддерживается.';uk='Спільне використання в групуваннях полів аналітики оборотів та інших полів не підтримується.'") ;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры

#Область НастройкаПараметровОтчета

Процедура УстановитьОбязательныеНастройки(ПользовательскиеНастройкиМодифицированы)
	
	СегментыСервер.ВключитьОтборПоСегментуНоменклатурыВСКД(КомпоновщикНастроек);
	
	ВидыЗапасовПоГФУ = Константы.ФормироватьВидыЗапасовПоГруппамФинансовогоУчета.Получить();
	КомпоновкаДанныхКлиентСервер.УстановитьПараметр(
	КомпоновщикНастроек, 
	"ФормироватьВидыЗапасовПоГруппамФинансовогоУчета", 
	ВидыЗапасовПоГФУ);
	
	КомпоновкаДанныхСервер.УстановитьПараметрыВалютыОтчета(КомпоновщикНастроек, ПользовательскиеНастройкиМодифицированы);
КонецПроцедуры

Функция ВспомогательныеПараметрыОтчета()
	ВспомогательныеПараметры = Новый Массив;
	
	КлючТекущегоВарианта = "";
	Если КомпоновщикНастроек.Настройки.ДополнительныеСвойства.Свойство("КлючТекущегоВарианта", КлючТекущегоВарианта) Тогда
		Если Не КлючТекущегоВарианта = "ДинамикаЗакупок" Тогда
			ВспомогательныеПараметры.Добавить("Периодичность");
		КонецЕсли;
	КонецЕсли;
	
	ВспомогательныеПараметры.Добавить("КоличественныеИтогиПоЕдИзм");
	
	ВспомогательныеПараметры.Добавить("МаксимумСерийКоличество");
	ВспомогательныеПараметры.Добавить("ВыделениеСерийДиаграмм");
	ВспомогательныеПараметры.Добавить("ОтслеживаемыеАналитики");
	ВспомогательныеПараметры.Добавить("ГрадиентСерийДиаграмм");
	ВспомогательныеПараметры.Добавить("ОтображениеМаркеровТочекДиаграмм");
	
	КомпоновкаДанныхСервер.ДобавитьВспомогательныеПараметрыОтчетаПоФункциональнымОпциям(ВспомогательныеПараметры);
	
	Возврат ВспомогательныеПараметры;
КонецФункции

Функция СтруктураЗаголовковПолей()
	СтруктураЗаголовковПолей = Новый Структура;
	
	СтруктураЗаголовковВалют = КомпоновкаДанныхСервер.СтруктураЗаголовковВалют(КомпоновщикНастроек);
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(СтруктураЗаголовковПолей, СтруктураЗаголовковВалют, Ложь);
	
	СтруктуруЗаголовковПолейЕдиницИзмерений = КомпоновкаДанныхСервер.СтруктураЗаголовковПолейЕдиницИзмерений(КомпоновщикНастроек);
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(СтруктураЗаголовковПолей, СтруктуруЗаголовковПолейЕдиницИзмерений, Ложь);
	
	Возврат СтруктураЗаголовковПолей;
КонецФункции

Процедура УдалитьПоказателиИзОтборовРасшифровки(КомпоновщикНастроек)
	Если КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.Свойство("РежимРасшифровки")
		И КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.РежимРасшифровки Тогда
		Показатели = Новый Массив;
		Показатели.Добавить("Показатели.Количество.КоличествоНачальныйОстаток");
		Показатели.Добавить("Показатели.Количество.КоличествоПриход");
		Показатели.Добавить("Показатели.Количество.КоличествоРасход");
		Показатели.Добавить("Показатели.Количество.КоличествоКонечныйОстаток");
		Показатели.Добавить("Показатели.Вес.ВесНачальныйОстаток");
		Показатели.Добавить("Показатели.Вес.ВесПриход");
		Показатели.Добавить("Показатели.Вес.ВесРасход");
		Показатели.Добавить("Показатели.Вес.ВесКонечныйОстаток");
		Показатели.Добавить("Показатели.Объем.ОбъемНачальныйОстаток");
		Показатели.Добавить("Показатели.Объем.ОбъемПриход");
		Показатели.Добавить("Показатели.Объем.ОбъемРасход");
		Показатели.Добавить("Показатели.Объем.ОбъемКонечныйОстаток");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияНачальныйОстаток");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияПриход");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияРасход");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияКонечныйОстаток");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыНачальныйОстаток");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыПриход");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыРасход");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыКонечныйОстаток");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьНачальныйОстаток");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьПриход");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьРасход");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьКонечныйОстаток");
		
		Для Каждого Показатель Из Показатели Цикл 
			КомпоновкаДанныхСервер.УдалитьЭлементОтбораИзВсехНастроекОтчета(КомпоновщикНастроек, Показатель);
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти 

#Область ОбщиеФрагментыЗапросов

Функция ТекстЗапросаОтборыПоСегментам()
	ТекстЗапроса = "ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	Сегменты.Номенклатура КАК Номенклатура,
	|	Сегменты.Характеристика КАК Характеристика,
	|	ИСТИНА КАК ИспользуетсяОтборПоСегментуНоменклатуры
	|ПОМЕСТИТЬ ОтборПоСегментуНоменклатуры
	|ИЗ
	|	РегистрСведений.НоменклатураСегмента КАК Сегменты
	|{ГДЕ
	|	Сегменты.Сегмент.* КАК СегментНоменклатуры,
	|	Сегменты.Номенклатура.* КАК Номенклатура,
	|	Сегменты.Характеристика.* КАК Характеристика}
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Номенклатура,
	|	Характеристика,
	|	ИспользуетсяОтборПоСегментуНоменклатуры
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	Сегменты.Партнер КАК Партнер,
	|	ИСТИНА КАК ИспользуетсяОтборПоСегментуПартнеров
	|ПОМЕСТИТЬ ОтборПоСегментуПартнеров
	|ИЗ
	|	РегистрСведений.ПартнерыСегмента КАК Сегменты
	|{ГДЕ
	|	Сегменты.Сегмент.* КАК СегментПартнеров,
	|	Сегменты.Партнер.* КАК Партнер}
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Партнер,
	|	ИспользуетсяОтборПоСегментуПартнеров
	|;";
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаЗарегистрированныеВводыОстатков()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ВводОстатков.Ссылка
	|ПОМЕСТИТЬ ЗарегистрированныеВводыОстатков
	|ИЗ
	|	Документ.ВводОстатков КАК ВводОстатков
	|ГДЕ
	|	ВводОстатков.ТипОперации В (
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.УдалитьОстаткиСобственныхТоваровНаАдресномСкладе),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиСобственныхТоваров),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиТоваровПереданныхНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиВозвратнойТарыПринятойОтПоставщиков),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.УдалитьОстаткиВозвратнойТарыПринятойОтПоставщиковНаАдресномСкладе),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиТоваровПолученныхНаКомиссию),
	|		ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхПереработчикам)
	|		)
	|	И ВводОстатков.Дата МЕЖДУ &НачалоПериода И &КонецПериода
	|	И ВводОстатков.Проведен
	|;";
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти

#Область ОсновнаяАналитика

Функция ТекстЗапросаСебестоимостьТоваровОстаткиИОбороты()
	ТекстЗапроса = "
	|///////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                     КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения    КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов   КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                   КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                            КАК Серия,
	|	АналитикаНоменклатуры.Склад                            КАК Склад,
	|	
	|	СебестоимостьТоваровОстатки.ВидЗапасов               КАК ВидЗапасов,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Поставщик     КАК Партнер,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Менеджер      КАК Менеджер,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Подразделение КАК Подразделение,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	СебестоимостьТоваровОстатки.Организация КАК Организация,
	|	
	|	// Аналитика остатков и оборотов без детализации
	|	СебестоимостьТоваровОстатки.РазделУчета КАК РазделУчета,
	|	
	|	// Показатель ""Количество""
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток КАК КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоПриход КАК КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоРасход КАК КоличествоРасход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток КАК КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток * &ТекстЗапросаВесУпаковки   КАК ВесНачальныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоПриход * &ТекстЗапросаВесУпаковки    КАК ВесПриход,
	|	СебестоимостьТоваровОстатки.КоличествоРасход * &ТекстЗапросаВесУпаковки    КАК ВесРасход,
	|	СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток * &ТекстЗапросаВесУпаковки    КАК ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток * &ТекстЗапросаОбъемУпаковки КАК ОбъемНачальныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоПриход * &ТекстЗапросаОбъемУпаковки  КАК ОбъемПриход,
	|	СебестоимостьТоваровОстатки.КоличествоРасход * &ТекстЗапросаОбъемУпаковки  КАК ОбъемРасход,
	|	СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток * &ТекстЗапросаОбъемУпаковки  КАК ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток
	|	КОНЕЦ КАК СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглПриход
	|	КОНЕЦ КАК СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглРасход
	|	КОНЕЦ КАК СтоимостьПоступленияРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьКонечныйОстаток 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток 
	|	КОНЕЦ	КАК СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК ДопРасходыРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьНачальныйОстаток + СебестоимостьТоваровОстатки.СуммаДопРасходовНачальныйОстаток 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСНачальныйОстаток 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток
	|	КОНЕЦ КАК СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьПриход + СебестоимостьТоваровОстатки.СуммаДопРасходовПриход 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСПриход + СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСПриход 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглПриход
	|	КОНЕЦ КАК СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРасход + СебестоимостьТоваровОстатки.СуммаДопРасходовРасход 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСРасход + СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСРасход 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглРасход
	|	КОНЕЦ КАК СебестоимостьРасход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьКонечныйОстаток + СебестоимостьТоваровОстатки.СуммаДопРасходовКонечныйОстаток 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.СуммаДопРасходовБезНДСКонечныйОстаток 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток
	|	КОНЕЦ КАК СебестоимостьКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	ВидЗапасов.*,
	|	Партнер.*,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	РазделУчета.*,
	|	КоличествоНачальныйОстаток,
	|	КоличествоПриход,
	|	КоличествоРасход,
	|	КоличествоКонечныйОстаток,
	|	ВесНачальныйОстаток,
	|	ВесПриход,
	|	ВесРасход,
	|	ВесКонечныйОстаток,
	|	ОбъемНачальныйОстаток,
	|	ОбъемПриход,
	|	ОбъемРасход,
	|	ОбъемКонечныйОстаток,
	|	СтоимостьПоступленияНачальныйОстаток,
	|	СтоимостьПоступленияПриход,
	|	СтоимостьПоступленияРасход,
	|	СтоимостьПоступленияКонечныйОстаток,
	|	ДопРасходыНачальныйОстаток,
	|	ДопРасходыПриход,
	|	ДопРасходыРасход,
	|	ДопРасходыКонечныйОстаток,
	|	СебестоимостьНачальныйОстаток,
	|	СебестоимостьПриход,
	|	СебестоимостьРасход,
	|	СебестоимостьКонечныйОстаток}
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(
	|		{&НачалоПериода}, {&КонецПериода}, Авто, , 
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|		 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|		 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|		 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад,
	|		 (Организация).* КАК Организация}) КАК СебестоимостьТоваровОстатки
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|	}
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодГод,       ГОД)       КАК ПериодГод,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.*,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Поставщик.* КАК Поставщик,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Менеджер.* КАК Менеджер,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	СебестоимостьТоваровОстатки.ВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения","АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения","АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти

#Область ОборотнаяАналитика

Функция ТекстЗапросаЗакупкиОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ЗакупкиОбороты"" КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ЗакупкиОбороты.АналитикаУчетаНоменклатуры            КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                   КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения  КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                 КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                          КАК Серия,
	|	АналитикаНоменклатуры.Склад                          КАК Склад,
	|	
	|	ЗакупкиОбороты.ВидЗапасов               КАК ВидЗапасов,
	|	ЗакупкиОбороты.ВидЗапасов.Поставщик     КАК Партнер,
	|	ЗакупкиОбороты.ВидЗапасов.Менеджер      КАК Менеджер,
	|	ЗакупкиОбороты.ВидЗапасов.Подразделение КАК Подразделение,
	|	ЗакупкиОбороты.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ЗакупкиОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ЗакупкиОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL                                                                 КАК СтатьяДоходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)  КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)  КАК СтатьяДоходовРасходов,
	|	NULL                                                                 КАК АналитикаДоходов,
	|	NULL                                                                 КАК АналитикаРасходов,
	|	NULL                                                                 КАК АналитикаДоходовРасходов,
	|	ЗакупкиОбороты.Договор                                               КАК Договор,
	|	ЗакупкиОбороты.Заказ                                                 КАК Заказ,
	|	ЗакупкиОбороты.Контрагент                                            КАК Контрагент,
	|	ЗакупкиОбороты.Соглашение                                            КАК Соглашение,
	|	ЗакупкиОбороты.ТипЗапасов                                            КАК ТипЗапасов,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Ссылка = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ЗакупкаУДругойОрганизации)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеализацияТоваровВДругуюОрганизацию)
	|		ИНАЧЕ НастройкиХозопераций.Ссылка
	|	КОНЕЦ КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                                КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                                КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ЗакупкиОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
    |		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию), ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссиюИмпорт))
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 
	|				ВЫБОР 
	|					КОГДА &ДанныеОтчета = 1 
	|						ТОГДА ЗакупкиОбороты.СтоимостьОборот
	|					КОГДА &ДанныеОтчета = 2 
	|						ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот
	|					КОГДА &ДанныеОтчета = 3 
	|						ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|				КОНЕЦ
	|			ИНАЧЕ 0
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	ВЫБОР 
    |		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию), ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссиюИмпорт))
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 
	|				ВЫБОР 
	|					КОГДА &ДанныеОтчета = 1 
	|						ТОГДА ЗакупкиОбороты.СтоимостьОборот
	|					КОГДА &ДанныеОтчета = 2 
	|						ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот
	|					КОГДА &ДанныеОтчета = 3 
	|						ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|				КОНЕЦ
	|			ИНАЧЕ 0
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
    |		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию), ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссиюИмпорт))
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 
	|				ВЫБОР 
	|					КОГДА &ДанныеОтчета = 1 
	|						ТОГДА ЗакупкиОбороты.СуммаДопРасходовОборот
	|					КОГДА &ДанныеОтчета = 2 
	|						ТОГДА ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|					КОГДА &ДанныеОтчета = 3 
	|						ТОГДА 0
	|				КОНЕЦ
	|			ИНАЧЕ 0
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
    |		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию), ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссиюИмпорт))
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 
	|				ВЫБОР 
	|					КОГДА &ДанныеОтчета = 1 
	|						ТОГДА ЗакупкиОбороты.СуммаДопРасходовОборот
	|					КОГДА &ДанныеОтчета = 2 
	|						ТОГДА ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|					КОГДА &ДанныеОтчета = 3 
	|						ТОГДА 0
	|				КОНЕЦ
	|			ИНАЧЕ 0
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
    |		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию), ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссиюИмпорт))
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 
	|				ВЫБОР 
	|					КОГДА &ДанныеОтчета = 1 
	|						ТОГДА ЗакупкиОбороты.СтоимостьОборот + ЗакупкиОбороты.СуммаДопРасходовОборот
	|					КОГДА &ДанныеОтчета = 2 
	|						ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот + ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|					КОГДА &ДанныеОтчета = 3 
	|						ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|				КОНЕЦ
	|			ИНАЧЕ 0
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
    |		КОГДА ЗакупкиОбороты.ХозяйственнаяОперация В (ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссию), ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПриемНаКомиссиюИмпорт))
	|				И ЗакупкиОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.НашеПредприятие)
	|		ТОГДА 0
	|		ИНАЧЕ 1
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 
	|				ВЫБОР 
	|					КОГДА &ДанныеОтчета = 1 
	|						ТОГДА ЗакупкиОбороты.СтоимостьОборот + ЗакупкиОбороты.СуммаДопРасходовОборот
	|					КОГДА &ДанныеОтчета = 2 
	|						ТОГДА ЗакупкиОбороты.СтоимостьБезНДСОборот + ЗакупкиОбороты.СуммаДопРасходовБезНДСОборот
	|					КОГДА &ДанныеОтчета = 3 
	|						ТОГДА ЗакупкиОбороты.СтоимостьРеглОборот
	|				КОНЕЦ
	|			ИНАЧЕ 0
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	НаборДанных,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	ВидЗапасов.*,
	|	Партнер.*,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор,
	|	Заказ,
	|	Контрагент,
	|	Соглашение,
	|	ТипЗапасов,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода,
	|	ХозяйственнаяОперацияРасхода,
	|	Об_КоличествоНачальныйОстаток,
	|	Об_КоличествоПриход,
	|	Об_КоличествоРасход,
	|	Об_КоличествоКонечныйОстаток,
	|	Об_ВесНачальныйОстаток,
	|	Об_ВесПриход,
	|	Об_ВесРасход,
	|	Об_ВесКонечныйОстаток,
	|	Об_ОбъемНачальныйОстаток,
	|	Об_ОбъемПриход,
	|	Об_ОбъемРасход,
	|	Об_ОбъемКонечныйОстаток,
	|	Об_СтоимостьПоступленияНачальныйОстаток,
	|	Об_СтоимостьПоступленияПриход,
	|	Об_СтоимостьПоступленияРасход,
	|	Об_СтоимостьПоступленияКонечныйОстаток,
	|	Об_ДопРасходыНачальныйОстаток,
	|	Об_ДопРасходыПриход,
	|	Об_ДопРасходыРасход,
	|	Об_ДопРасходыКонечныйОстаток,
	|	Об_СебестоимостьНачальныйОстаток,
	|	Об_СебестоимостьПриход,
	|	Об_СебестоимостьРасход,
	|	Об_СебестоимостьКонечныйОстаток}
	|ПОМЕСТИТЬ ОборотнаяАналитика
	|ИЗ
	|	РегистрНакопления.Закупки.Обороты({&НачалоПериода}, {&КонецПериода}, Авто, 
	|		НЕ АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)) КАК ЗакупкиОбороты
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ЗакупкиОбороты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ЗакупкиОбороты.ХозяйственнаяОперация
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ЗакупкиОбороты"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ЗакупкиОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ЗакупкиОбороты.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.*,
	|	АналитикаНоменклатуры.Серия.*,
	|	АналитикаНоменклатуры.Склад.*,
	|	ЗакупкиОбороты.ВидЗапасов.*,
	|	ЗакупкиОбороты.ВидЗапасов.Поставщик.* КАК Партнер,
	|	ЗакупкиОбороты.ВидЗапасов.Менеджер.* КАК Менеджер,
	|	ЗакупкиОбороты.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	ЗакупкиОбороты.ВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ЗакупкиОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	ЗакупкиОбороты.Организация.* КАК Организация,
	|	(NULL) КАК СтатьяДоходов,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)).* КАК СтатьяРасходов,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.СебестоимостьПродаж)).* КАК СтатьяДоходовРасходов,
	|	ЗакупкиОбороты.Договор.* КАК Договор,
	|	ЗакупкиОбороты.Заказ.* КАК Заказ,
	|	ЗакупкиОбороты.Контрагент.* КАК Контрагент,
	|	ЗакупкиОбороты.Соглашение.* КАК Соглашение,
	|	ЗакупкиОбороты.ТипЗапасов.* КАК ТипЗапасов,
	|	(ВЫБОР 
	|		КОГДА НастройкиХозопераций.Ссылка = ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ЗакупкаУДругойОрганизации)
	|			ТОГДА ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.РеализацияТоваровВДругуюОрганизацию)
	|		ИНАЧЕ НастройкиХозопераций.Ссылка
	|	КОНЕЦ).* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаВыручкаИСебестоимостьПродажОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ВыручкаИСебестоимостьПродажОбороты"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                            КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения           КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов          КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                          КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                   КАК Серия,
	|	АналитикаНоменклатуры.Склад                                   КАК Склад,
	|	
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов               КАК ВидЗапасов,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Поставщик     КАК Партнер,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Менеджер      КАК Менеджер,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Подразделение КАК Подразделение,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	АналитикаПартнеров.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)    КАК СтатьяДоходов,
	|	NULL                                                              КАК СтатьяРасходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)    КАК СтатьяДоходовРасходов,
	|	NULL                                                              КАК АналитикаДоходов,
	|	NULL                                                              КАК АналитикаРасходов,
	|	NULL                                                              КАК АналитикаДоходовРасходов,
	|	ВыручкаИСебестоимостьПродажОбороты.Договор                        КАК Договор,
	|	ВыручкаИСебестоимостьПродажОбороты.ЗаказКлиента                   КАК Заказ,
	|	АналитикаПартнеров.Контрагент                                     КАК Контрагент,
	|	ВыручкаИСебестоимостьПродажОбороты.Соглашение                     КАК Соглашение,
	|	ВыручкаИСебестоимостьПродажОбороты.ТипЗапасов                     КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                       КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ИЛИ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И НЕ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьРеглОборот
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьРеглОборот
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот) > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот) < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьБезНДСОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьРеглОборот
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот) > 0
	|			ТОГДА 1
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И (ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот) < 0
	|			ТОГДА -1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьБезНДСОборот + ВыручкаИСебестоимостьПродажОбороты.СуммаДополнительныхРасходовБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ВыручкаИСебестоимостьПродажОбороты.СебестоимостьРеглОборот
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|	
	|ИЗ
	|	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(
	|		{&НачалоПериода}, 
	|		{&КонецПериода}, 
	|		Авто, 
	|		НЕ АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|		{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, (АналитикаУчетаНоменклатуры.Склад).* КАК Склад, (АналитикаУчетаПоПартнерам.Организация).* КАК Склад}
	|		) КАК ВыручкаИСебестоимостьПродажОбороты
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаПартнеров
	|			ПО ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам = АналитикаПартнеров.КлючАналитики
	|		}
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ВыручкаИСебестоимостьПродажОбороты.ХозяйственнаяОперация
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ВыручкаИСебестоимостьПродажОбороты"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ВыручкаИСебестоимостьПродажОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.*,
	|	АналитикаНоменклатуры.Серия.*,
	|	АналитикаНоменклатуры.Склад.*,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.*,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Поставщик.* КАК Партнер,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Менеджер.* КАК Менеджер,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ВыручкаИСебестоимостьПродажОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	АналитикаПартнеров.Организация.* КАК Организация,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)).* КАК СтатьяДоходов,
	|	(NULL) КАК СтатьяРасходов,
	|	(ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ВыручкаОтПродаж)).* КАК СтатьяДоходовРасходов,
	|	ВыручкаИСебестоимостьПродажОбороты.Договор.* КАК Договор,
	|	ВыручкаИСебестоимостьПродажОбороты.ЗаказКлиента.* КАК Заказ,
	|	АналитикаПартнеров.Контрагент.* КАК Контрагент,
	|	ВыручкаИСебестоимостьПродажОбороты.Соглашение.* КАК Соглашение,
	|	ВыручкаИСебестоимостьПродажОбороты.ТипЗапасов.* КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ИЛИ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				И НЕ (НастройкиХозопераций.ХозяйственнаяОперация = Значение(Перечисление.ХозяйственныеОперации.ОприходованиеПоВозврату))
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыПриход()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДвиженияНоменклатураНоменклатураОборотыПриход"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                                          КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения                         КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов                        КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                                        КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                                 КАК Серия,
	|	АналитикаНоменклатуры.Склад                                                 КАК Склад,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов               КАК ВидЗапасов,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Поставщик     КАК Партнер,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Менеджер      КАК Менеджер,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Подразделение КАК Подразделение,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ КорАналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорТипЗапасов         КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                         КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА КорАналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / КорАналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураНоменклатураОборотыПриход.КорКоличествоОборот КАК Об_КоличествоПриход,
	|	0 КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорКоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесПриход,
	|	0 КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорКоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	0 КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	0 КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	0 КАК Об_ДопРасходыПриход,
	|	0 КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	0 КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|	
	|ИЗ
	|	РегистрНакопления.ДвиженияНоменклатураНоменклатура.Обороты({&НачалоПериода}, {&КонецПериода}, Авто, 
	|			{(Организация).* КАК Организация, (КорАналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, (КорАналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, (КорАналитикаУчетаНоменклатуры.Серия).* КАК Серия, (КорАналитикаУчетаНоменклатуры.Склад).* КАК Склад}
	|		) КАК ДвиженияНоменклатураНоменклатураОборотыПриход
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ДвиженияНоменклатураНоменклатураОборотыПриход.ХозяйственнаяОперация
	|ГДЕ 
	|	НЕ АналитикаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДвиженияНоменклатураНоменклатураОборотыПриход"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыПриход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры.* КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.* КАК ВидЗапасов,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Поставщик.* КАК Поставщик,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Менеджер.* КАК Менеджер,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Подразделение.* КАК Подразделение,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДвиженияНоменклатураНоменклатураОборотыПриход.КорВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ ДвиженияНоменклатураНоменклатураОборотыПриход.КорАналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.Организация КАК Организация,
	|	NULL КАК Заказ,
	|	ДвиженияНоменклатураНоменклатураОборотыПриход.КорТипЗапасов.* КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("КорАналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "КорАналитикаУчетаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("КорАналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "КорАналитикаУчетаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыРасход()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДвиженияНоменклатураНоменклатураОборотыРасход"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                                          КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения                         КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов                        КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                                        КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                                 КАК Серия,
	|	АналитикаНоменклатуры.Склад                                                 КАК Склад,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов               КАК ВидЗапасов,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Поставщик     КАК Партнер,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Менеджер      КАК Менеджер,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Подразделение КАК Подразделение,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ТипЗапасов            КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                         КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                               КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	0 КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураНоменклатураОборотыРасход.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	0 КАК Об_ВесПриход,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.КоличествоОборот * &ТекстЗапросаВесУпаковки КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	0 КАК Об_ОбъемПриход,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК Об_СтоимостьПоступленияПриход,
	| 	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	0 КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыПриход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	0 КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|	
	|ИЗ
	|	РегистрНакопления.ДвиженияНоменклатураНоменклатура.Обороты({&НачалоПериода}, {&КонецПериода}, Авто, 
	|			{(Организация).* КАК Организация, (АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, (АналитикаУчетаНоменклатуры.Склад).* КАК Склад}
	|		) КАК ДвиженияНоменклатураНоменклатураОборотыРасход
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ДвиженияНоменклатураНоменклатураОборотыРасход.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ДвиженияНоменклатураНоменклатураОборотыРасход.ХозяйственнаяОперация
	|ГДЕ 
	|	НЕ АналитикаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДвиженияНоменклатураНоменклатураОборотыРасход"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураНоменклатураОборотыРасход.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.*,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Поставщик.* КАК Поставщик,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Менеджер.* КАК Менеджер,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДвиженияНоменклатураНоменклатураОборотыРасход.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.Организация КАК Организация,
	|	NULL КАК Заказ,
	|	ДвиженияНоменклатураНоменклатураОборотыРасход.ТипЗапасов.*,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДвиженияНоменклатураДоходыРасходыОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДвиженияНоменклатураДоходыРасходыОбороты"" КАК НаборДанных,
	|	
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                                  КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения                 КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов                КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                                КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                                         КАК Серия,
	|	АналитикаНоменклатуры.Склад                                         КАК Склад,
	|	
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов               КАК ВидЗапасов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Поставщик     КАК Партнер,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Менеджер      КАК Менеджер,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Подразделение КАК Подразделение,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	
	|	ДвиженияНоменклатураДоходыРасходыОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	ВЫБОР
	|		КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов Ссылка ПланВидовХарактеристик.СтатьиДоходов
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|	КОНЕЦ                                                             КАК СтатьяДоходов,
	|	ВЫБОР
	|		КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов Ссылка ПланВидовХарактеристик.СтатьиРасходов
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|	КОНЕЦ                                                             КАК СтатьяРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов    КАК СтатьяДоходовРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов         КАК АналитикаДоходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов        КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов
	|	КОНЕЦ                                                             КАК АналитикаДоходовРасходов,
	|	NULL                                                              КАК Договор,
	|	NULL                                                              КАК Заказ,
	|	NULL                                                              КАК Контрагент,
	|	NULL                                                              КАК Соглашение,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ТипЗапасов               КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка                                       КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ                                                             КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки   КАК Об_ВесПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаВесУпаковки   КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ДвиженияНоменклатураДоходыРасходыОбороты.КоличествоОборот * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК Об_СтоимостьПоступленияПриход,
	|	0 КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьОборот
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьОборот 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|			ТОГДА 1
	|			ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьОборот 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьБезНДСОборот 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтоимостьРеглОборот
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|
	|ИЗ
	|	РегистрНакопления.ДвиженияНоменклатураДоходыРасходы.Обороты({&НачалоПериода}, {&КонецПериода}, Авто, 
	|		НЕ АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)) КАК ДвиженияНоменклатураДоходыРасходыОбороты
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|			ПО ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|		}
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = ДвиженияНоменклатураДоходыРасходыОбороты.ХозяйственнаяОперация
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДвиженияНоменклатураДоходыРасходыОбороты"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДвиженияНоменклатураДоходыРасходыОбороты.ПериодГод,       ГОД)       КАК ПериодГод,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.*,
	|	АналитикаНоменклатуры.Серия.*,
	|	АналитикаНоменклатуры.Склад.*,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.*,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Поставщик.*     КАК Поставщик,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Менеджер.*      КАК Менеджер,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.Сделка.*        КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).*                                                        КАК ГруппаФинансовогоУчета,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.Организация.*              КАК Организация,
	|	NULL                                                                КАК Заказ,
	|	(ВЫБОР
	|			КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов ССЫЛКА ПланВидовХарактеристик.СтатьиДоходов
	|				ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|		КОНЕЦ).*                                                        КАК СтатьяДоходов,
	|	(ВЫБОР
	|			КОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов ССЫЛКА ПланВидовХарактеристик.СтатьиРасходов
	|				ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов
	|			ИНАЧЕ NULL
	|		КОНЕЦ).*                                                        КАК СтатьяРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.СтатьяДоходовРасходов.*    КАК СтатьяДоходовРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов.*         КАК АналитикаДоходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов.*        КАК АналитикаРасходов,
	|	(ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА ДвиженияНоменклатураДоходыРасходыОбороты.АналитикаРасходов
	|	КОНЕЦ).*                                                            КАК АналитикаДоходовРасходов,
	|	ДвиженияНоменклатураДоходыРасходыОбороты.ТипЗапасов.*               КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка.*                                       КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Приход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ)                                                          КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА НастройкиХозопераций.Расход = ЗНАЧЕНИЕ(Перечисление.ТипыДанныхУчета.Номенклатура)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ)                                                          КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаДополнениеВводОстатков()
	ТекстЗапроса = "
	|///////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	""ДополнениеВводОстатков"" КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодГод,        ГОД)      КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	ДополнениеВводОстатков.АналитикаУчетаНоменклатуры    КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                   КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения  КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                 КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                          КАК Серия,
	|	АналитикаНоменклатуры.Склад                          КАК Склад,
	|	
	|	ДополнениеВводОстатков.ВидЗапасов               КАК ВидЗапасов,
	|	ДополнениеВводОстатков.ВидЗапасов.Поставщик     КАК Партнер,
	|	ДополнениеВводОстатков.ВидЗапасов.Менеджер      КАК Менеджер,
	|	ДополнениеВводОстатков.ВидЗапасов.Подразделение КАК Подразделение,
	|	ДополнениеВводОстатков.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА ДополнениеВводОстатков.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	ДополнениеВводОстатков.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	NULL КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка КАК ХозяйственнаяОперацияСправочник,
	|	ИСТИНА КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР
	|		КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|		ТОГДА Истина
	|		ИНАЧЕ Ложь
	|	КОНЕЦ КАК ХозяйственнаяОперацияРасхода,
	|
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДополнениеВводОстатков.КоличествоПриход КАК Об_КоличествоПриход,
	|	ВЫБОР 
	|		КОГДА &ЕдиницыКоличества = 0 
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1 
	|			ТОГДА
	|				ВЫБОР 
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0 
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|						ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * ДополнениеВводОстатков.КоличествоРасход КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	ДополнениеВводОстатков.КоличествоПриход * &ТекстЗапросаВесУпаковки   КАК Об_ВесПриход,
	|	ДополнениеВводОстатков.КоличествоРасход * &ТекстЗапросаВесУпаковки    КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	ДополнениеВводОстатков.КоличествоПриход * &ТекстЗапросаОбъемУпаковки КАК Об_ОбъемПриход,
	|	ДополнениеВводОстатков.КоличествоРасход * &ТекстЗапросаОбъемУпаковки  КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглПриход
	|	КОНЕЦ КАК Об_СтоимостьПоступленияПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРасход 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСРасход 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглРасход 
	|	КОНЕЦ КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СуммаДопРасходовПриход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СуммаДопРасходовБезНДСПриход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Об_ДопРасходыПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СуммаДопРасходовРасход
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СуммаДопРасходовБезНДСРасход
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьПриход + ДополнениеВводОстатков.СуммаДопРасходовПриход 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСПриход + ДополнениеВводОстатков.СуммаДопРасходовБезНДСПриход 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглПриход
	|	КОНЕЦ КАК Об_СебестоимостьПриход,
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРасход + ДополнениеВводОстатков.СуммаДопРасходовРасход 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьБезНДСРасход + ДополнениеВводОстатков.СуммаДопРасходовБезНДСРасход 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА ДополнениеВводОстатков.СтоимостьРеглРасход
	|	КОНЕЦ КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|	
	|ИЗ
	|	ЗарегистрированныеВводыОстатков КАК ЗарегистрированныеВводыОстатков
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.СебестоимостьТоваров.Обороты(
	|							{&НачалоПериода}, {&КонецПериода}, Авто, 
	|							{(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|							 (АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|							 (АналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|							 (АналитикаУчетаНоменклатуры.Склад).* КАК Склад}) КАК ДополнениеВводОстатков
	|	ПО ЗарегистрированныеВводыОстатков.Ссылка = ДополнениеВводОстатков.Регистратор
	|	
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО ДополнениеВводОстатков.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|	}
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО ВЫБОР
	|				КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|					ТОГДА ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПередачаВПроизводство)
	|				ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ОприходованиеТоваров)
	|			КОНЕЦ = НастройкиХозопераций.ХозяйственнаяОперация
	|ГДЕ
	|	НЕ ДополнениеВводОстатков.АналитикаУчетаНоменклатуры.Номенклатура.ТипНоменклатуры = ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга)
	|{ГДЕ
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(""ДополнениеВводОстатков"") КАК НаборДанных,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДень,      ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодНеделя,    НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодДекада,    ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодМесяц,     МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодКвартал,   КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ДополнениеВводОстатков.ПериодГод,        ГОД)      КАК ПериодГод,
	|	ДополнениеВводОстатков.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.*,
	|	АналитикаНоменклатуры.Серия.*,
	|	АналитикаНоменклатуры.Склад.*,
	|	ДополнениеВводОстатков.ВидЗапасов.*,
	|	ДополнениеВводОстатков.ВидЗапасов.Поставщик.* КАК Поставщик,
	|	ДополнениеВводОстатков.ВидЗапасов.Менеджер.* КАК Менеджер,
	|	ДополнениеВводОстатков.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	ДополнениеВводОстатков.ВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА ДополнениеВводОстатков.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	ДополнениеВводОстатков.Организация.*,
	|	NULL КАК Заказ,
	|	НастройкиХозопераций.Ссылка.* КАК ХозяйственнаяОперацияСправочник,
	|	(ВЫБОР
	|			КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ИСТИНА
	|		КОНЕЦ) КАК ХозяйственнаяОперацияПрихода,
	|	(ВЫБОР
	|			КОГДА ЗарегистрированныеВводыОстатков.Ссылка.ТипОперации = ЗНАЧЕНИЕ(Перечисление.ТипыОперацийВводаОстатков.ОстаткиМатериаловПереданныхВПроизводство)
	|				ТОГДА ИСТИНА
	|			ИНАЧЕ ЛОЖЬ
	|		КОНЕЦ) КАК ХозяйственнаяОперацияРасхода}";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ТекстЗапросаКлассифицированныеОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	КлассифицированныеОбороты.НаборДанных КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	КлассифицированныеОбороты.ПериодДень      КАК ПериодДень,
	|	КлассифицированныеОбороты.ПериодНеделя    КАК ПериодНеделя,
	|	КлассифицированныеОбороты.ПериодДекада    КАК ПериодДекада,
	|	КлассифицированныеОбороты.ПериодМесяц     КАК ПериодМесяц,
	|	КлассифицированныеОбороты.ПериодКвартал   КАК ПериодКвартал,
	|	КлассифицированныеОбороты.ПериодПолугодие КАК ПериодПолугодие,
	|	КлассифицированныеОбороты.ПериодГод       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	КлассифицированныеОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	КлассифицированныеОбороты.Номенклатура               КАК Номенклатура,
	|	КлассифицированныеОбороты.ЕдиницаХранения           КАК ЕдиницаХранения,
	|	КлассифицированныеОбороты.ЕдиницаДляОтчетов          КАК ЕдиницаДляОтчетов,
	|	КлассифицированныеОбороты.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	КлассифицированныеОбороты.Характеристика             КАК Характеристика,
	|	КлассифицированныеОбороты.Серия                      КАК Серия,
	|	КлассифицированныеОбороты.Склад                      КАК Склад,
	|	
	|	КлассифицированныеОбороты.ВидЗапасов    КАК ВидЗапасов,
	|	КлассифицированныеОбороты.Партнер       КАК Партнер,
	|	КлассифицированныеОбороты.Менеджер      КАК Менеджер,
	|	КлассифицированныеОбороты.Подразделение КАК Подразделение,
	|	КлассифицированныеОбороты.Сделка        КАК Сделка,
	|	
	|	КлассифицированныеОбороты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	
	|	КлассифицированныеОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	КлассифицированныеОбороты.СтатьяДоходов КАК СтатьяДоходов,
	|	КлассифицированныеОбороты.СтатьяРасходов КАК СтатьяРасходов,
	|	КлассифицированныеОбороты.СтатьяДоходовРасходов КАК СтатьяДоходовРасходов,
	|	КлассифицированныеОбороты.АналитикаДоходов КАК АналитикаДоходов,
	|	КлассифицированныеОбороты.АналитикаРасходов КАК АналитикаРасходов,
	|	КлассифицированныеОбороты.АналитикаДоходовРасходов КАК АналитикаДоходовРасходов,
	|	КлассифицированныеОбороты.Договор КАК Договор,
	|	КлассифицированныеОбороты.Заказ КАК Заказ,
	|	КлассифицированныеОбороты.Контрагент КАК Контрагент,
	|	КлассифицированныеОбороты.Соглашение КАК Соглашение,
	|	КлассифицированныеОбороты.ТипЗапасов КАК ТипЗапасов,
	|	КлассифицированныеОбороты.ХозяйственнаяОперацияСправочник КАК ХозяйственнаяОперацияСправочник,
	|	КлассифицированныеОбороты.ХозяйственнаяОперацияПрихода КАК ХозяйственнаяОперацияПрихода,
	|	КлассифицированныеОбороты.ХозяйственнаяОперацияРасхода КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	КлассифицированныеОбороты.Об_КоличествоНачальныйОстаток КАК Об_КоличествоНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_КоличествоПриход КАК Об_КоличествоПриход,
	|	КлассифицированныеОбороты.Об_КоличествоРасход КАК Об_КоличествоРасход,
	|	КлассифицированныеОбороты.Об_КоличествоКонечныйОстаток КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	КлассифицированныеОбороты.Об_ВесНачальныйОстаток КАК Об_ВесНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ВесПриход КАК Об_ВесПриход,
	|	КлассифицированныеОбороты.Об_ВесРасход КАК Об_ВесРасход,
	|	КлассифицированныеОбороты.Об_ВесКонечныйОстаток КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	КлассифицированныеОбороты.Об_ОбъемНачальныйОстаток КАК Об_ОбъемНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ОбъемПриход КАК Об_ОбъемПриход,
	|	КлассифицированныеОбороты.Об_ОбъемРасход КАК Об_ОбъемРасход,
	|	КлассифицированныеОбороты.Об_ОбъемКонечныйОстаток КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияНачальныйОстаток КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияПриход КАК Об_СтоимостьПоступленияПриход,
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияРасход КАК Об_СтоимостьПоступленияРасход,
	|	КлассифицированныеОбороты.Об_СтоимостьПоступленияКонечныйОстаток КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	КлассифицированныеОбороты.Об_ДопРасходыНачальныйОстаток КАК Об_ДопРасходыНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_ДопРасходыПриход КАК Об_ДопРасходыПриход,
	|	КлассифицированныеОбороты.Об_ДопРасходыРасход КАК Об_ДопРасходыРасход,
	|	КлассифицированныеОбороты.Об_ДопРасходыКонечныйОстаток КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	КлассифицированныеОбороты.Об_СебестоимостьНачальныйОстаток КАК Об_СебестоимостьНачальныйОстаток,
	|	КлассифицированныеОбороты.Об_СебестоимостьПриход КАК Об_СебестоимостьПриход,
	|	КлассифицированныеОбороты.Об_СебестоимостьРасход КАК Об_СебестоимостьРасход,
	|	КлассифицированныеОбороты.Об_СебестоимостьКонечныйОстаток КАК Об_СебестоимостьКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	НаборДанных,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	ВидЗапасов.*,
	|	Партнер.*,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор,
	|	Заказ,
	|	Контрагент,
	|	Соглашение,
	|	ТипЗапасов,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода,
	|	ХозяйственнаяОперацияРасхода,
	|	Об_КоличествоНачальныйОстаток,
	|	Об_КоличествоПриход,
	|	Об_КоличествоРасход,
	|	Об_КоличествоКонечныйОстаток,
	|	Об_ВесНачальныйОстаток,
	|	Об_ВесПриход,
	|	Об_ВесРасход,
	|	Об_ВесКонечныйОстаток,
	|	Об_ОбъемНачальныйОстаток,
	|	Об_ОбъемПриход,
	|	Об_ОбъемРасход,
	|	Об_ОбъемКонечныйОстаток,
	|	Об_СтоимостьПоступленияНачальныйОстаток,
	|	Об_СтоимостьПоступленияПриход,
	|	Об_СтоимостьПоступленияРасход,
	|	Об_СтоимостьПоступленияКонечныйОстаток,
	|	Об_ДопРасходыНачальныйОстаток,
	|	Об_ДопРасходыПриход,
	|	Об_ДопРасходыРасход,
	|	Об_ДопРасходыКонечныйОстаток,
	|	Об_СебестоимостьНачальныйОстаток,
	|	Об_СебестоимостьПриход,
	|	Об_СебестоимостьРасход,
	|	Об_СебестоимостьКонечныйОстаток}
	|ИЗ
	|	ОборотнаяАналитика КАК КлассифицированныеОбороты";
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти 

#Область НеклассифицированныеОбороты

Функция ТекстЗапросаНеклассифицированныеОбороты()
	ТекстЗапроса = "
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	""НеклассифицированныеОбороты"" КАК НаборДанных,
	|
	|	// Аналитика периодов
	|	НеклассифицированныеОбороты.ПериодДень      КАК ПериодДень,
	|	НеклассифицированныеОбороты.ПериодНеделя    КАК ПериодНеделя,
	|	НеклассифицированныеОбороты.ПериодДекада    КАК ПериодДекада,
	|	НеклассифицированныеОбороты.ПериодМесяц     КАК ПериодМесяц,
	|	НеклассифицированныеОбороты.ПериодКвартал   КАК ПериодКвартал,
	|	НеклассифицированныеОбороты.ПериодПолугодие КАК ПериодПолугодие,
	|	НеклассифицированныеОбороты.ПериодГод       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	НеклассифицированныеОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	НеклассифицированныеОбороты.Номенклатура               КАК Номенклатура,
	|	НеклассифицированныеОбороты.ЕдиницаХранения            КАК ЕдиницаХранения,
	|	НеклассифицированныеОбороты.ЕдиницаДляОтчетов          КАК ЕдиницаДляОтчетов,
	|	НеклассифицированныеОбороты.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	НеклассифицированныеОбороты.Характеристика             КАК Характеристика,
	|	НеклассифицированныеОбороты.Серия                      КАК Серия,
	|	НеклассифицированныеОбороты.Склад                      КАК Склад,
	|	
	|	НеклассифицированныеОбороты.ВидЗапасов    КАК ВидЗапасов,
	|	НеклассифицированныеОбороты.Партнер       КАК Партнер,
	|	НеклассифицированныеОбороты.Менеджер      КАК Менеджер,
	|	НеклассифицированныеОбороты.Подразделение КАК Подразделение,
	|	НеклассифицированныеОбороты.Сделка        КАК Сделка,
	|	
	|	НеклассифицированныеОбороты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	
	|	НеклассифицированныеОбороты.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	NULL КАК ТипЗапасов,
	|	NULL КАК ХозяйственнаяОперацияСправочник,
	|	ИСТИНА КАК ХозяйственнаяОперацияПрихода,
	|	ИСТИНА КАК ХозяйственнаяОперацияРасхода,
	|	
	|	// Показатель ""Количество""
	|	0 КАК Об_КоличествоНачальныйОстаток,
	|	0 КАК Об_КоличествоПриход,
	|	0 КАК Об_КоличествоРасход,
	|	0 КАК Об_КоличествоКонечныйОстаток,
	|	
	|	// Показатели ""Вес""
	|	0 КАК Об_ВесНачальныйОстаток,
	|	0 КАК Об_ВесПриход,
	|	0 КАК Об_ВесРасход,
	|	0 КАК Об_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Об_ОбъемНачальныйОстаток,
	|	0 КАК Об_ОбъемПриход,
	|	0 КАК Об_ОбъемРасход,
	|	0 КАК Об_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Об_СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК Об_СтоимостьПоступленияПриход,
	|	0 КАК Об_СтоимостьПоступленияРасход,
	|	0 КАК Об_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Об_ДопРасходыНачальныйОстаток,
	|	0 КАК Об_ДопРасходыПриход,
	|	0 КАК Об_ДопРасходыРасход,
	|	0 КАК Об_ДопРасходыКонечныйОстаток,
	|	
	|	// Показатель ""Себестоимость""
	|	0 КАК Об_СебестоимостьНачальныйОстаток,
	|	0 КАК Об_СебестоимостьПриход,
	|	0 КАК Об_СебестоимостьРасход,
	|	0 КАК Об_СебестоимостьКонечныйОстаток
	|	
	|ИЗ
	|	ОборотнаяАналитика КАК НеклассифицированныеОбороты
	|{ГДЕ
	|	(NULL) КАК СтатьяДоходов,
	|	(NULL) КАК СтатьяРасходов,
	|	(NULL) КАК СтатьяДоходовРасходов,
	|	(NULL) КАК АналитикаДоходов,
	|	(NULL) КАК АналитикаРасходов,
	|	(NULL) КАК АналитикаДоходовРасходов,
	|	(NULL) КАК Договор,
	|	(NULL) КАК Заказ,
	|	(NULL) КАК Контрагент,
	|	(NULL) КАК Соглашение,
	|	(NULL) КАК ТипЗапасов,
	|	(NULL) КАК ХозяйственнаяОперацияСправочник}";
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти 

#Область АналитикаПоДокументу
	
Функция ТекстЗапросаСебестоимостьТоваровОборотыПоЗаписям()
	ТекстЗапроса = "
	|///////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|
	|	// Аналитика периодов
	|	Записи.ПериодДень,
	|	Записи.ПериодНеделя,
	|	Записи.ПериодДекада,
	|	Записи.ПериодМесяц,
	|	Записи.ПериодКвартал,
	|	Записи.ПериодПолугодие,
	|	Записи.ПериодГод,
	|
	|	// Общая аналитика
	|	Записи.АналитикаУчетаНоменклатуры,
	|	Записи.Номенклатура,
	|	Записи.ЕдиницаХранения,
	|	Записи.ЕдиницаДляОтчетов,
	|	Записи.Характеристика,
	|	Записи.Серия,
	|	Записи.Склад,
	|	Записи.ВидЗапасов,
	|	Записи.Партнер,
	|	Записи.Менеджер,
	|	Записи.Подразделение,
	|	Записи.Сделка,
	|	Записи.ГруппаФинансовогоУчета,
	|	Записи.Организация,
	|
	|	// Аналитика оборотов
	|	Записи.СтатьяДоходов.Ссылка КАК СтатьяДоходов,
	|	Записи.СтатьяРасходов.Ссылка КАК СтатьяРасходов,
	|	Записи.СтатьяДоходовРасходов.Ссылка КАК СтатьяДоходовРасходов,
	|	ВЫБОР
	|		КОГДА Записи.АналитикаДоходов = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.АналитикаДоходов
	|	КОНЕЦ КАК АналитикаДоходов,
	|	ВЫБОР
	|		КОГДА Записи.АналитикаРасходов = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.АналитикаРасходов
	|	КОНЕЦ КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА Записи.АналитикаДоходовРасходов = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.АналитикаДоходовРасходов
	|	КОНЕЦ КАК АналитикаДоходовРасходов,
	|	Записи.Договор.Ссылка КАК Договор,
	|	ВЫБОР
	|		КОГДА Записи.Заказ = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.Заказ
	|	КОНЕЦ КАК Заказ,
	|	Записи.Контрагент.Ссылка КАК Контрагент,
	|	ВЫБОР
	|		КОГДА Записи.Соглашение = НЕОПРЕДЕЛЕНО
	|			ТОГДА NULL
	|		ИНАЧЕ Записи.Соглашение
	|	КОНЕЦ КАК Соглашение,
	|	Записи.ТипЗапасов КАК ТипЗапасов,
	|	Записи.ХозяйственнаяОперацияСправочник КАК ХозяйственнаяОперацияСправочник,
	|	Записи.ХозяйственнаяОперацияПрихода,
	|	Записи.ХозяйственнаяОперацияРасхода,
	|
	|	// Аналитика-документ
	|	Записи.Документ,
	|
	|	// Показатель ""Количество""
	|	Записи.Док_КоличествоНачальныйОстаток,
	|	Записи.Док_КоличествоПриход,
	|	Записи.Док_КоличествоРасход,
	|	Записи.Док_КоличествоКонечныйОстаток,
	|
	|	// Показатель ""Вес""
	|	Записи.Док_ВесНачальныйОстаток,
	|	Записи.Док_ВесПриход,
	|	Записи.Док_ВесРасход,
	|	Записи.Док_ВесКонечныйОстаток,
	|
	|	// Показатель ""Объем""
	|	Записи.Док_ОбъемНачальныйОстаток,
	|	Записи.Док_ОбъемПриход,
	|	Записи.Док_ОбъемРасход,
	|	Записи.Док_ОбъемКонечныйОстаток,
	|
	|	// Показатель ""СтоимостьПоступдения""
	|	Записи.Док_СтоимостьПоступленияНачальныйОстаток,
	|	Записи.Док_СтоимостьПоступленияПриход,
	|	Записи.Док_СтоимостьПоступленияРасход,
	|	Записи.Док_СтоимостьПоступленияКонечныйОстаток,
	|
	|	// Показатель ""ДопРасходы""
	|	Записи.Док_ДопРасходыНачальныйОстаток,
	|	Записи.Док_ДопРасходыПриход,
	|	Записи.Док_ДопРасходыРасход,
	|	Записи.Док_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	Записи.Док_СебестоимостьНачальныйОстаток,
	|	Записи.Док_СебестоимостьПриход,
	|	Записи.Док_СебестоимостьРасход,
	|	Записи.Док_СебестоимостьКонечныйОстаток
	|ИЗ
	|	(ВЫБРАТЬ
	|
	|	// Аналитика периодов
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ГОД)       КАК ПериодГод,
	|	
	|	// Общая аналитика
	|	СебестоимостьТоваровЗаписи.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура                     КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения    КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов   КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов   КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика                   КАК Характеристика,
	|	АналитикаНоменклатуры.Серия                            КАК Серия,
	|	АналитикаНоменклатуры.Склад                            КАК Склад,
	|	
	|	СебестоимостьТоваровЗаписи.ВидЗапасов               КАК ВидЗапасов,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Поставщик     КАК Партнер,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Менеджер      КАК Менеджер,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Подразделение КАК Подразделение,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Сделка        КАК Сделка,
	|	
	|	ВЫБОР 
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета 
	|			ТОГДА СебестоимостьТоваровЗаписи.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|
	|	СебестоимостьТоваровЗаписи.Организация КАК Организация,
	|	
	|	// Аналитика оборотов
	|	СебестоимостьТоваровЗаписи.СтатьяДоходов КАК СтатьяДоходов,
	|	СебестоимостьТоваровЗаписи.СтатьяРасходовСписания КАК СтатьяРасходов,
	|	ВЫБОР
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяДоходов.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяДоходов
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяРасходовСписания.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяРасходовСписания
	|	КОНЕЦ                          КАК СтатьяДоходовРасходов,
	|	СебестоимостьТоваровЗаписи.АналитикаДоходов КАК АналитикаДоходов,
	|	СебестоимостьТоваровЗаписи.АналитикаРасходов КАК АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаРасходов
	|	КОНЕЦ                          КАК АналитикаДоходовРасходов,
	|ВЫБОР
	|	КОГДА (СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL 
	|		ТОГДА ВЫБОР
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.АктВыполненныхРабот
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.АктВыполненныхРабот).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВводОстатков
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВводОстатков).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровМеждуОрганизациями).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровОтКлиента).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровПоставщику
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровПоставщику).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаПоступления
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаПоступления).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаРеализации
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаРеализации).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионера
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионера).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионераОСписании).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомитентуОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомитентуОСписании).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетПоКомиссииМеждуОрганизациями).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПередачаТоваровМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПередачаТоваровМеждуОрганизациями).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПоступлениеТоваровУслуг).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.РеализацияТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.РеализацияТоваровУслуг).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ТаможеннаяДекларацияИмпорт).Договор
	|				ИНАЧЕ NULL
	|			КОНЕЦ
	|	ИНАЧЕ ВЫБОР
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.АктВыполненныхРабот
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.АктВыполненныхРабот).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВводОстатков
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВводОстатков).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровМеждуОрганизациями).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровПоставщику).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаПоступления
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаПоступления).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаРеализации).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионера).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионераОСписании).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомитентуОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомитентуОСписании).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетПоКомиссииМеждуОрганизациями).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПередачаТоваровМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПередачаТоваровМеждуОрганизациями).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.РеализацияТоваровУслуг).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ТаможеннаяДекларацияИмпорт).Договор
	|			ИНАЧЕ NULL
	|			КОНЕЦ
	|КОНЕЦ КАК Договор,
	|	СебестоимостьТоваровЗаписи.ЗаказКлиента КАК Заказ,
	|ВЫБОР
	|	КОГДА (СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL 
	|		ТОГДА ВЫБОР
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.АктВыполненныхРабот
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.АктВыполненныхРабот).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВводОстатков
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВводОстатков).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровМеждуОрганизациями).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровОтКлиента).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровПоставщику
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровПоставщику).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаПоступления
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаПоступления).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаРеализации
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаРеализации).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионера
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионера).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионераОСписании).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомитентуОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомитентуОСписании).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетПоКомиссииМеждуОрганизациями).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПоступлениеТоваровУслуг).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.РеализацияТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.РеализацияТоваровУслуг).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ТаможеннаяДекларацияИмпорт).Контрагент
	|				ИНАЧЕ NULL
	|			КОНЕЦ
	|	ИНАЧЕ ВЫБОР
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.АктВыполненныхРабот
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.АктВыполненныхРабот).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВводОстатков
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВводОстатков).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровМеждуОрганизациями).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровПоставщику).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаПоступления
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаПоступления).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаРеализации).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионера).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионераОСписании).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомитентуОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомитентуОСписании).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетПоКомиссииМеждуОрганизациями).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.РеализацияТоваровУслуг).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ТаможеннаяДекларацияИмпорт).Контрагент
	|			ИНАЧЕ NULL
	|			КОНЕЦ
	|КОНЕЦ КАК Контрагент,
	|ВЫБОР
	|	КОГДА (СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL 
	|		ТОГДА ВЫБОР
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.АктВыполненныхРабот
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.АктВыполненныхРабот).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровОтКлиента).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровПоставщику
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровПоставщику).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаПоступления
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаПоступления).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаРеализации
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаРеализации).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионера
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионера).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионераОСписании).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомитентуОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомитентуОСписании).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПоступлениеТоваровУслуг).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.РеализацияТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.РеализацияТоваровУслуг).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ТаможеннаяДекларацияИмпорт).ПоступлениеСоглашение
	|				ИНАЧЕ NULL
	|			КОНЕЦ
	|	ИНАЧЕ ВЫБОР
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.АктВыполненныхРабот
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.АктВыполненныхРабот).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровПоставщику).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаПоступления
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаПоступления).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаРеализации).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионера).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионераОСписании).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомитентуОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомитентуОСписании).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.РеализацияТоваровУслуг).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ТаможеннаяДекларацияИмпорт).ПоступлениеСоглашение
	|			ИНАЧЕ NULL
	|			КОНЕЦ
	|КОНЕЦ КАК Соглашение,
	|	NULL КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ 
	|	КОНЕЦ КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ 
	|	КОНЕЦ КАК ХозяйственнаяОперацияРасхода,
	|
	|	// Аналитика-документ
	|	ВЫБОР 
	|		КОГДА (СебестоимостьТоваровЗаписи.Регистратор Ссылка Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваровЗаписи.Регистратор
	|	КОНЕЦ КАК Документ,
	|
	|	// Показатель ""Количество""
	|	0 КАК Док_КоличествоНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ  * ВЫБОР КОГДА &ЕдиницыКоличества = 0 ТОГДА 1 ИНАЧЕ 1/АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество КАК Док_КоличествоПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ  * ВЫБОР КОГДА &ЕдиницыКоличества = 0 ТОГДА 1 ИНАЧЕ 1/АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество КАК Док_КоличествоРасход,
	|	0 КАК Док_КоличествоКонечныйОстаток,
	|	
	|	// Показатель ""Вес""
	|	0   КАК Док_ВесНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаВесУпаковки    КАК Док_ВесПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаВесУпаковки    КАК Док_ВесРасход,
	|	0    КАК Док_ВесКонечныйОстаток,
	|	
	|	// Показатель ""Объем""
	|	0 КАК Док_ОбъемНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаОбъемУпаковки  КАК Док_ОбъемПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	СебестоимостьТоваровЗаписи.Количество * &ТекстЗапросаОбъемУпаковки  КАК Док_ОбъемРасход,
	|	0  КАК Док_ОбъемКонечныйОстаток,
	|	
	|	// Показатель ""Стоимость""
	|	0 КАК Док_СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|	КОНЕЦ КАК Док_СтоимостьПоступленияПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|	КОНЕЦ КАК Док_СтоимостьПоступленияРасход,
	|	0	КАК Док_СтоимостьПоступленияКонечныйОстаток,
	|	
	|	// Показатель ""Доп. расходы""
	|	0 КАК Док_ДопРасходыНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.СуммаДопРасходов
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СуммаДопРасходовБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Док_ДопРасходыПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.СуммаДопРасходов
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СуммаДопРасходовБезНДС
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА 0
	|	КОНЕЦ КАК Док_ДопРасходыРасход,
	|	0 КАК Док_ДопРасходыКонечныйОстаток,
	|
	|	// Показатель ""Себестоимость""
	|	0 КАК Док_СебестоимостьНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость + СебестоимостьТоваровЗаписи.СуммаДопРасходов 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС + СебестоимостьТоваровЗаписи.СуммаДопРасходовБезНДС 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|	КОНЕЦ КАК Док_СебестоимостьПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваровЗаписи.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) 
	|		ТОГДА 1
	|		ИНАЧЕ 0 
	|	КОНЕЦ *
	|	ВЫБОР 
	|		КОГДА &ДанныеОтчета = 1 
	|			ТОГДА СебестоимостьТоваровЗаписи.Стоимость + СебестоимостьТоваровЗаписи.СуммаДопРасходов 
	|		КОГДА &ДанныеОтчета = 2 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьБезНДС + СебестоимостьТоваровЗаписи.СуммаДопРасходовБезНДС 
	|		КОГДА &ДанныеОтчета = 3 
	|			ТОГДА СебестоимостьТоваровЗаписи.СтоимостьРегл
	|	КОНЕЦ КАК Док_СебестоимостьРасход,
	|	0 КАК Док_СебестоимостьКонечныйОстаток
	|	
	|{ВЫБРАТЬ
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	ВидЗапасов.*,
	|	Партнер.*,
	|	Менеджер.*,
	|	Подразделение.*,
	|	Сделка.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор,
	|	Заказ,
	|	Контрагент,
	|	Соглашение,
	|	ТипЗапасов,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода,
	|	ХозяйственнаяОперацияРасхода,
	|	Документ.*,
	|	Док_КоличествоНачальныйОстаток,
	|	Док_КоличествоПриход,
	|	Док_КоличествоРасход,
	|	Док_КоличествоКонечныйОстаток,
	|	Док_ВесНачальныйОстаток,
	|	Док_ВесПриход,
	|	Док_ВесРасход,
	|	Док_ВесКонечныйОстаток,
	|	Док_ОбъемНачальныйОстаток,
	|	Док_ОбъемПриход,
	|	Док_ОбъемРасход,
	|	Док_ОбъемКонечныйОстаток,
	|	Док_СтоимостьПоступленияНачальныйОстаток,
	|	Док_СтоимостьПоступленияПриход,
	|	Док_СтоимостьПоступленияРасход,
	|	Док_СтоимостьПоступленияКонечныйОстаток,
	|	Док_ДопРасходыНачальныйОстаток,
	|	Док_ДопРасходыПриход,
	|	Док_ДопРасходыРасход,
	|	Док_ДопРасходыКонечныйОстаток,
	|	Док_СебестоимостьНачальныйОстаток,
	|	Док_СебестоимостьПриход,
	|	Док_СебестоимостьРасход,
	|	Док_СебестоимостьКонечныйОстаток}
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваровЗаписи
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО СебестоимостьТоваровЗаписи.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.КлючАналитики
	|	}
	|	{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаПартнеров
	|		ПО СебестоимостьТоваровЗаписи.АналитикаУчетаПоПартнерам = АналитикаПартнеров.КлючАналитики
	|	}
	|	ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО НастройкиХозопераций.ХозяйственнаяОперация = СебестоимостьТоваровЗаписи.ХозяйственнаяОперация
	|{ГДЕ
	|	СебестоимостьТоваровЗаписи.Период >= &НачалоПериода
	|		И СебестоимостьТоваровЗаписи.Период <= &КонецПериода,
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	(НастройкиХозопераций.Ссылка) КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР 
	|		КОГДА (СебестоимостьТоваровЗаписи.Регистратор Ссылка Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.ДокументДвижения
	|			ИНАЧЕ СебестоимостьТоваровЗаписи.Регистратор
	|	КОНЕЦ КАК Документ,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕНЬ)      КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, НЕДЕЛЯ)    КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ДЕКАДА)    КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, МЕСЯЦ)     КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, КВАРТАЛ)   КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровЗаписи.Период, ГОД)       КАК ПериодГод,
	|	СебестоимостьТоваровЗаписи.АналитикаУчетаНоменклатуры.*,
	|	АналитикаНоменклатуры.Номенклатура.*,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.*,
	|	АналитикаНоменклатуры.Серия.*,
	|	АналитикаНоменклатуры.Склад.*,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.*,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Поставщик.* КАК Поставщик,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Менеджер.* КАК Менеджер,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Подразделение.* КАК Подразделение,
	|	СебестоимостьТоваровЗаписи.ВидЗапасов.Сделка.* КАК Сделка,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваровЗаписи.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета,
	|	СебестоимостьТоваровЗаписи.Организация.*,
	|	СебестоимостьТоваровЗаписи.СтатьяДоходов.* КАК СтатьяДоходов,
	|	СебестоимостьТоваровЗаписи.СтатьяРасходовСписания.* КАК СтатьяРасходов,
	|	(ВЫБОР
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяДоходов.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяДоходов
	|		КОГДА НЕ СебестоимостьТоваровЗаписи.СтатьяРасходовСписания.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.СтатьяРасходовСписания
	|	КОНЕЦ).*                          КАК СтатьяДоходовРасходов,
	|	СебестоимостьТоваровЗаписи.АналитикаДоходов.* КАК АналитикаДоходов,
	|	СебестоимостьТоваровЗаписи.АналитикаРасходов.* КАК АналитикаРасходов,
	|	(ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваровЗаписи.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваровЗаписи.АналитикаРасходов
	|	КОНЕЦ).*                          КАК АналитикаДоходовРасходов,
	|(ВЫБОР
	|	КОГДА (СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL 
	|		ТОГДА ВЫБОР
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.АктВыполненныхРабот
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.АктВыполненныхРабот).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВводОстатков
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВводОстатков).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровМеждуОрганизациями).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровОтКлиента).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровПоставщику
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровПоставщику).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаПоступления
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаПоступления).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаРеализации
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаРеализации).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионера
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионера).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионераОСписании).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомитентуОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомитентуОСписании).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетПоКомиссииМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетПоКомиссииМеждуОрганизациями).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПоступлениеТоваровУслуг).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.РеализацияТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.РеализацияТоваровУслуг).Договор
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ТаможеннаяДекларацияИмпорт).Договор
	|				ИНАЧЕ NULL
	|			КОНЕЦ
	|	ИНАЧЕ ВЫБОР
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.АктВыполненныхРабот
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.АктВыполненныхРабот).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВводОстатков
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВводОстатков).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровМеждуОрганизациями).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровПоставщику).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаПоступления
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаПоступления).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаРеализации).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионера).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионераОСписании).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомитентуОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомитентуОСписании).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПередачаТоваровМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПередачаТоваровМеждуОрганизациями).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.РеализацияТоваровУслуг).Договор
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ТаможеннаяДекларацияИмпорт).Договор
	|			ИНАЧЕ NULL
	|			КОНЕЦ
	|КОНЕЦ).* КАК Договор,
	|	(СебестоимостьТоваровЗаписи.ЗаказКлиента).* КАК Заказ,
	|(ВЫБОР
	|	КОГДА (СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL 
	|		ТОГДА ВЫБОР
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.АктВыполненныхРабот
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.АктВыполненныхРабот).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВводОстатков
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВводОстатков).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровМеждуОрганизациями).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровОтКлиента).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровПоставщику
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровПоставщику).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаПоступления
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаПоступления).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаРеализации
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаРеализации).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионера
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионера).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионераОСписании).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомитентуОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомитентуОСписании).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПоступлениеТоваровУслуг).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.РеализацияТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.РеализацияТоваровУслуг).Контрагент
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ТаможеннаяДекларацияИмпорт).Контрагент
	|				ИНАЧЕ NULL
	|			КОНЕЦ
	|	ИНАЧЕ ВЫБОР
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.АктВыполненныхРабот
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.АктВыполненныхРабот).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВводОстатков
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВводОстатков).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровМеждуОрганизациями
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровМеждуОрганизациями).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровПоставщику).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаПоступления
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаПоступления).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаРеализации).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионера).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионераОСписании).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомитентуОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомитентуОСписании).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.РеализацияТоваровУслуг).Контрагент
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ТаможеннаяДекларацияИмпорт).Контрагент
	|			ИНАЧЕ NULL
	|			КОНЕЦ
	|КОНЕЦ).* КАК Контрагент,
	|(ВЫБОР
	|	КОГДА (СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РасчетСебестоимостиТоваров ИЛИ СебестоимостьТоваровЗаписи.РасчетСебестоимости)
	|			И НЕ СебестоимостьТоваровЗаписи.ХозяйственнаяОперация.Ссылка ЕСТЬ NULL 
	|		ТОГДА ВЫБОР
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.АктВыполненныхРабот
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.АктВыполненныхРабот).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровОтКлиента).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ВозвратТоваровПоставщику
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ВозвратТоваровПоставщику).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаПоступления
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаПоступления).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.КорректировкаРеализации
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.КорректировкаРеализации).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионера
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионера).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомиссионераОСписании).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ОтчетКомитентуОСписании
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ОтчетКомитентуОСписании).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ПоступлениеТоваровУслуг).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.РеализацияТоваровУслуг
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.РеализацияТоваровУслуг).Соглашение
	|				КОГДА СебестоимостьТоваровЗаписи.ДокументДвижения ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|					ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.ДокументДвижения КАК Документ.ТаможеннаяДекларацияИмпорт).ПоступлениеСоглашение
	|				ИНАЧЕ NULL
	|			КОНЕЦ
	|	ИНАЧЕ ВЫБОР
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.АктВыполненныхРабот
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.АктВыполненныхРабот).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровОтКлиента).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ВозвратТоваровПоставщику
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ВозвратТоваровПоставщику).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаПоступления
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаПоступления).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.КорректировкаРеализации
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.КорректировкаРеализации).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионера
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионера).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомиссионераОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомиссионераОСписании).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ОтчетКомитентуОСписании
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ОтчетКомитентуОСписании).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ПоступлениеТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ПоступлениеТоваровУслуг).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.РеализацияТоваровУслуг).Соглашение
	|			КОГДА СебестоимостьТоваровЗаписи.Регистратор ССЫЛКА Документ.ТаможеннаяДекларацияИмпорт
	|				ТОГДА ВЫРАЗИТЬ(СебестоимостьТоваровЗаписи.Регистратор КАК Документ.ТаможеннаяДекларацияИмпорт).ПоступлениеСоглашение
	|			ИНАЧЕ NULL
	|			КОНЕЦ
	|КОНЕЦ).* КАК Соглашение}) КАК Записи";
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));	
	
	Возврат ТекстЗапроса;
КонецФункции

#КонецОбласти 

Функция ИсполняемыйЗапросОсновнаяАналитика()
	ТекстЗапроса = ТекстЗапросаОтборыПоСегментам(); 
	
	КоличествоПодключенныхЗапросов = 0;
	
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаСебестоимостьТоваровОстаткиИОбороты(), КоличествоПодключенныхЗапросов);
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ИсполняемыйЗапросОборотнаяАналитика()
	ТекстЗапроса = ТекстЗапросаОтборыПоСегментам() 
		+ ТекстЗапросаЗарегистрированныеВводыОстатков();
	
	КоличествоПодключенныхЗапросов = 0;
	
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаЗакупкиОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаВыручкаИСебестоимостьПродажОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыПриход(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДвиженияНоменклатураНоменклатураОборотыРасход(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДвиженияНоменклатураДоходыРасходыОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаДополнениеВводОстатков(), КоличествоПодключенныхЗапросов);
	
	ТекстЗапроса = ТекстЗапроса + Символы.ПС + ";" + Символы.ПС;
	
	КоличествоПодключенныхЗапросов = 0;
	
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаКлассифицированныеОбороты(), КоличествоПодключенныхЗапросов);
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаНеклассифицированныеОбороты(), КоличествоПодключенныхЗапросов);
	
	Возврат ТекстЗапроса;
КонецФункции

Функция ИсполняемыйЗапросДокументы()
	ТекстЗапроса = ТекстЗапросаОтборыПоСегментам() 
		+ ТекстЗапросаЗарегистрированныеВводыОстатков();
	
	КоличествоПодключенныхЗапросов = 0;
	ПодключитьЗапрос(ТекстЗапроса, ТекстЗапросаСебестоимостьТоваровОборотыПоЗаписям(), КоличествоПодключенныхЗапросов);
	
	Возврат ТекстЗапроса;
КонецФункции

Процедура ПодключитьЗапрос(ДинамическийТекстЗапроса, ПодключаемыйЗапрос, КоличествоПодключенныхЗапросов)
	Если Не ПустаяСтрока(ПодключаемыйЗапрос) Тогда
		Если КоличествоПодключенныхЗапросов = 0 Тогда
			ДинамическийТекстЗапроса = ДинамическийТекстЗапроса + ПодключаемыйЗапрос;
		Иначе
			ПодключаемыйЗапрос = СтрЗаменить(ПодключаемыйЗапрос, "РАЗРЕШЕННЫЕ", "");
			
			ДинамическийТекстЗапроса = ДинамическийТекстЗапроса + Символы.ПС + Символы.ПС 
			+ "ОБЪЕДИНИТЬ ВСЕ" + Символы.ПС + Символы.ПС;
			
			ДинамическийТекстЗапроса = ДинамическийТекстЗапроса + ПодключаемыйЗапрос;
		КонецЕсли;
		
		КоличествоПодключенныхЗапросов = КоличествоПодключенныхЗапросов + 1;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти 

#КонецЕсли
