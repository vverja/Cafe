#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Заполняет переданный список обособленными подразделениями, доступными организации
//
// Параметры:
//    Организация - СправочникСсылка.Организации - Организация, по которой производится поиск кассовых книг
//    СписокОбособленныхПодразделений - СписокЗначений - Заполняемый список
//
Процедура ОбособленныеПодразделенияОрганизации(Организация, СписокОбособленныхПодразделений) Экспорт
	
	СписокОбособленныхПодразделений.Очистить();
	
	Если ЗначениеЗаполнено(Организация) Тогда
		
		
		Запрос = Новый Запрос("
		|ВЫБРАТЬ
		|	ОбособленныеПодразделенияОрганизаций.Ссылка КАК ОбособленноеПодразделение
		|ИЗ
		|	Справочник.ОбособленныеПодразделенияОрганизаций КАК ОбособленныеПодразделенияОрганизаций
		|ГДЕ
		|	ОбособленныеПодразделенияОрганизаций.Владелец = &Организация
		|");
		
		Запрос.УстановитьПараметр("Организация", Организация);
		
		Выборка = Запрос.Выполнить().Выбрать();
		Пока Выборка.Следующий() Цикл
			СписокОбособленныхПодразделений.Добавить(Выборка.ОбособленноеПодразделение);
		КонецЦикла;
	КонецЕсли;
	
КонецПроцедуры // ОбособленныеПодразделенияОрганизации

#КонецОбласти


#КонецЕсли