// Код частично предоставлен разработчиками сервиса Пактум.Контрагент
// Сервисное обслуживание сервиса Пактум.Контрагент осуществляется 
// линией консультаций разработчиков:
// • e-mail pactum.contragent@gmail.com
// • тел. + 380 (67) 430-04-50.


// Инициирует структуру данных контрагента для сравнения с данными полученных с сервиса.
//
// Возвращаемое значение:
//   Булево   - инициированная значениями по умолчанию структура.
//
Функция ИнициироватьСтруктураДанныхДляСравнения() Экспорт

	ДанныеДляСравнения = Новый Структура;
	ДанныеДляСравнения.Вставить("КодПоЕДРПОУ", "");
	ДанныеДляСравнения.Вставить("ИННПлательщикаНДС", "");
    ДанныеДляСравнения.Вставить("НомерСвидетельстваПлательщикаНДС", "");
    ДанныеДляСравнения.Вставить("ПлательщикНДС", Ложь);
	ДанныеДляСравнения.Вставить("Наименование", "");
	ДанныеДляСравнения.Вставить("НаименованиеПолное", "");
	ДанныеДляСравнения.Вставить("ЮридическийАдрес", "");
    ДанныеДляСравнения.Вставить("ДополнительнаяИнформация", "");
	ДанныеДляСравнения.Вставить("Телефон", "");
    ДанныеДляСравнения.Вставить("АдресЭП", "");
	
	Возврат ДанныеДляСравнения;
	
КонецФункции

// Сравнивает имеющиеся значения реквизитов контрагента с данными, полученными с сервиса.
//
// Параметры:
//  РеквизитыКонтрагента  - Структура - содержит данные, полученные с сервиса.
//  ДанныеОбъекта         - Структура - содержит данные контрагента.
//
// Возвращаемое значение:
//   Булево   - Истина, если есть различия, Ложь в обратном случае.
//
Функция РезультатСравненияПолученныхДанныхКонтрагентаСИмеющимися(РеквизитыКонтрагента, ДанныеОбъекта, ЗаполнятьЕДРПОУ) Экспорт
	
	Результат = Новый Структура("ЕстьИзменения, ЕстьИзмененияВЗаполненныхРеквизитах", Ложь, Ложь);
	
	Если РеквизитыКонтрагента.Свойство("КодПоЕДРПОУ") И РеквизитыКонтрагента.КодПоЕДРПОУ <> ДанныеОбъекта.КодПоЕДРПОУ Тогда
		Результат.ЕстьИзменения = Истина;
		Если ЗначениеЗаполнено(ДанныеОбъекта.КодПоЕДРПОУ) Тогда
			Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
		КонецЕсли;
		
		Возврат Результат;
	КонецЕсли;
	
	Если РеквизитыКонтрагента.Свойство("ИННПлательщикаНДС") И РеквизитыКонтрагента.ИННПлательщикаНДС <> ДанныеОбъекта.ИННПлательщикаНДС Тогда
		Результат.ЕстьИзменения = Истина;
		Если ЗначениеЗаполнено(ДанныеОбъекта.ИННПлательщикаНДС) Тогда
			Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
		КонецЕсли;
		
		Возврат Результат;
    КонецЕсли;
    
	Если РеквизитыКонтрагента.Свойство("НомерСвидетельстваПлательщикаНДС") И РеквизитыКонтрагента.НомерСвидетельстваПлательщикаНДС <> ДанныеОбъекта.НомерСвидетельстваПлательщикаНДС Тогда
		Результат.ЕстьИзменения = Истина;
		Если ЗначениеЗаполнено(ДанныеОбъекта.НомерСвидетельстваПлательщикаНДС) Тогда
			Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
		КонецЕсли;
		
		Возврат Результат;
    КонецЕсли;
    
	Если РеквизитыКонтрагента.Свойство("ПлательщикНДС") И РеквизитыКонтрагента.ПлательщикНДС <> ДанныеОбъекта.ПлательщикНДС Тогда
		Результат.ЕстьИзменения = Истина;
		
		Возврат Результат;
	КонецЕсли;
	
	Если РеквизитыКонтрагента.Свойство("Наименование") 
		И РеквизитыКонтрагента.Наименование <> ДанныеОбъекта.Наименование Тогда
		Результат.ЕстьИзменения = Истина;
		Если ЗначениеЗаполнено(ДанныеОбъекта.Наименование) Тогда
			Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
		КонецЕсли;
		
		Возврат Результат;
	КонецЕсли;
	
	Если РеквизитыКонтрагента.Свойство("НаименованиеПолное") 
		И РеквизитыКонтрагента.НаименованиеПолное <> ДанныеОбъекта.НаименованиеПолное Тогда
		Результат.ЕстьИзменения = Истина;
		Если ЗначениеЗаполнено(ДанныеОбъекта.НаименованиеПолное) Тогда
			Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
		КонецЕсли;
		
		Возврат Результат;
	КонецЕсли;
	
	Если РеквизитыКонтрагента.Свойство("Телефон") 
		И РеквизитыКонтрагента.Телефон <> Неопределено Тогда
		Если РеквизитыКонтрагента.Телефон.Представление <> ДанныеОбъекта.Телефон Тогда
			
			Результат.ЕстьИзменения = Истина;
			Если ЗначениеЗаполнено(ДанныеОбъекта.Телефон) Тогда
				Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
			КонецЕсли;
			
			Возврат Результат;
		КонецЕсли;
    КонецЕсли;
    
	Если РеквизитыКонтрагента.Свойство("АдресЭП") 
		И РеквизитыКонтрагента.АдресЭП <> Неопределено Тогда
		Если РеквизитыКонтрагента.АдресЭП.Представление <> ДанныеОбъекта.АдресЭП Тогда
			
			Результат.ЕстьИзменения = Истина;
			Если ЗначениеЗаполнено(ДанныеОбъекта.АдресЭП) Тогда
				Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
			КонецЕсли;
			
			Возврат Результат;
		КонецЕсли;
	КонецЕсли;
	
	Если РеквизитыКонтрагента.Свойство("ЮридическийАдрес")
		И РеквизитыКонтрагента.ЮридическийАдрес <> Неопределено Тогда
		Если РеквизитыКонтрагента.ЮридическийАдрес.Представление <> ДанныеОбъекта.ЮридическийАдрес Тогда
			
			Результат.ЕстьИзменения = Истина;
			Если ЗначениеЗаполнено(ДанныеОбъекта.ЮридическийАдрес) Тогда
				Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
			КонецЕсли;
			
			Возврат Результат;
		КонецЕсли;
    КонецЕсли;
    
	Если РеквизитыКонтрагента.Свойство("ДополнительнаяИнформация")
		И РеквизитыКонтрагента.ДополнительнаяИнформация <> Неопределено Тогда
		Если РеквизитыКонтрагента.ДополнительнаяИнформация <> ДанныеОбъекта.ДополнительнаяИнформация Тогда
			
			Результат.ЕстьИзменения = Истина;
			Если ЗначениеЗаполнено(ДанныеОбъекта.ДополнительнаяИнформация) Тогда
				Результат.ЕстьИзмененияВЗаполненныхРеквизитах = Истина;
			КонецЕсли;
			
			Возврат Результат;
		КонецЕсли;
	КонецЕсли;
    
	
	Возврат Результат;
	
КонецФункции

// Формирует текст ошибки и показывает пользователю предупреждение на основании данных
// предоставленных подсистемой Пактум.Контрагент
// Параметры:
//  ОписаниеОшибки - Строка - описание ошибки, предоставленное подсистемой Пактум.Контрагент
//
Процедура ПоказатьПользователюОшибкуПолученияРеквизитовКонтрагентаПоЕДРПОУ(ОписаниеОшибки) Экспорт
	
	Если ПустаяСтрока(ОписаниеОшибки) Тогда
		ТекстПредупреждения = НСтр("ru='При получении данных из сервиса Пактум.Контрагент произошла неизвестная ошибка.';uk='При отриманні даних з сервісу Пактум.Контрагент сталася невідома помилка.'");
	Иначе
		ТекстПредупреждения = ОписаниеОшибки;
	КонецЕсли;
	
	ПоказатьПредупреждение(, ТекстПредупреждения);
	
КонецПроцедуры

// Показывает пользователю предупреждение на основании данных предоставленных подсистемой Пактум.Контрагент
// Параметры:
//  ОписаниеПредупреждения  - Строка - описание предупреждения, предоставленное подсистемой Пактум.Контрагент
//
Процедура ПоказатьПользователюПредупреждениеПолученияРеквизитовКонтрагентаПоЕДРПОУ(ОписаниеПредупреждения) Экспорт
    
    ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеПредупреждения);
	
КонецПроцедуры

Процедура ЗаблокироватьФорму(пФорма) Экспорт
    пФорма.Элементы.ЗаполнитьПоЕГРПОУ.Видимость = Ложь;
    пФорма.Элементы.ДекорацияЗаполнитьПоЕГРПОУ.Видимость = Истина;
	пФорма.ТолькоПросмотр = Истина;
КонецПроцедуры

Процедура РазблокироватьФорму(пФорма) Экспорт
    пФорма.Элементы.ЗаполнитьПоЕГРПОУ.Видимость = Истина;
    пФорма.Элементы.ДекорацияЗаполнитьПоЕГРПОУ.Видимость = Ложь;
	пФорма.ТолькоПросмотр = Ложь;
КонецПроцедуры

Процедура Лого_Нажатие() Экспорт
	ЗапуститьПриложение("http://pactumsys.com");
КонецПроцедуры
